{"version":3,"sources":["config.js","log.js","gallery.js"],"names":["config","backEnd","maxSize","thumbnail","batchProcessing","squareImage","floatPrecision","classify","name","modelPath","score","topK","detect","overlap","person","type","div","dot","Log","innerHTML","result","msg","msgs","map","a","replace","scrollTop","scrollHeight","length","fetch","then","res","text","console","log","active","Active","init","document","getElementById","results","filtered","popupConfig","showDetails","showBoxes","showFaces","listConfig","drawBoxes","img","object","canvas","style","position","left","offsetLeft","top","offsetTop","width","height","ctx","getContext","clearRect","linewidth","font","resizeX","processedSize","resizeY","strokeStyle","fillStyle","obj","x","box","y","beginPath","rect","stroke","fillText","toFixed","class","face","pointSize","pt","points","arc","Math","PI","fill","JSONtoStr","json","JSON","stringify","showPopup","$","toggle","find","image","classified","detected","age","scoreGender","gender","scoreEmotion","emotion","nsfw","scoreClass","desc","descriptions","description","lines","exif","mp","naturalWidth","naturalHeight","complexity","bytes","make","model","lens","toLocaleString","created","Date","modified","software","exposure","fov","iso","apperture","location","city","state","country","continent","near","lat","lon","html","perf","total","tags","css","showNextDetails","id","findIndex","src","printResult","camera","divItem","createElement","className","decodeURI","naturalSize","append","addEventListener","evt","target","filterWord","word","skip","includes","filter","ok","tag","str","Object","values","toString","startsWith","toLowerCase","filterResults","words","foundWords","split","shuffle","array","currentIndex","temporaryValue","randomIndex","floor","random","findDuplicates","items","hash","push","Set","sortResults","sort","b","pixels","loadGallery","initHandlers","click","toggleClass","focus","keyup","event","preventDefault","keyCode","value","screenX","window","innerWidth","keydown","current","page","bottom","prop","stop","animate","main","onload"],"mappings":"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","file":"gallery.js","sourceRoot":"../client","sourcesContent":["/* eslint-disable no-multi-spaces */\n\nconst config = {\n  // General configuration\n  backEnd: 'webgl',        // back-end used by tensorflow for image processing, can be webgl, cpu, wasm\n  maxSize: 780,            // maximum image width or height that will be used for processing before resizing is required\n  thumbnail: 128,          // resolution in which to store image thumbnail embedded in result set\n  batchProcessing: 20,     // how many images to process in parallel\n  squareImage: false,      // resize proportional to the original image or to a square image\n  floatPrecision: false,    // use float32 or float16 for WebGL tensors\n\n  // Default models\n  classify: { name: 'Inception v3', modelPath: 'models/inception-v3/model.json', score: 0.2, topK: 3 },\n  detect: { name: 'Coco/SSD v2', modelPath: 'models/cocossd-v2/model.json', score: 0.4, topK: 6, overlap: 0.1 },\n  person: { name: 'FaceAPI SSD', modelPath: 'models/faceapi/', score: 0.4, topK: 1, type: 'ssdMobilenetv1' },\n\n  // alternative classification models - you can pick none of one\n  /*\n  classify: { name: 'MobileNet v1', modelPath: '/models/mobilenet-v1/model.json' },\n  classify: { name: 'MobileNet v2', modelPath: '/models/mobilenet-v2/model.json' },\n  classify: { name: 'Inception v1', modelPath: 'https://tfhub.dev/google/tfjs-model/imagenet/inception_v1/classification/3/default/1' },\n  classify: { name: 'Inception v2', modelPath: 'https://tfhub.dev/google/tfjs-model/imagenet/inception_v2/classification/3/default/1' },\n  classify: { name: 'Inception v3', modelPath: '/models/inception-v3/model.json' },\n  classify: { name: 'Inception ResNet v2', modelPath: '/models/inception-resnet-v2/model.json' },\n  classify: { name: 'ResNet v2', modelPath: 'https://tfhub.dev/google/tfjs-model/imagenet/resnet_v2_101/classification/3/default/1' },\n  classify: { name: 'NasNet Mobile', modelPath: 'https://tfhub.dev/google/tfjs-model/imagenet/nasnet_mobile/classification/3/default/1' },\n  */\n\n  // alternative detect models: enable darknet/yolo model in a separate module - you can pick none, enable coco/ssd-v2 or enable darknet/yolo (not js module is initialized by default)\n  // detect: { name: 'Coco/SSD v2', modelPath: 'models/cocossd-v2/model.json', score: 0.4, topK: 6, overlap: 0.1 },\n\n  // alternative face-api models - you can pick none or one of following\n  /*\n  person: { name: 'FaceAPI SSD', modelPath: 'models/faceapi/', score: 0.5, topK: 1, type: 'ssdMobilenetv1' },\n  person: { name: 'FaceAPI Yolo', modelPath: 'models/faceapi/', score: 0.5, topK: 1, type: 'tinyYolov2' },\n  person: { name: 'FaceAPI Tiny', modelPath: 'models/faceapi/', score: 0.5, topK: 1, type: 'tinyFaceDetector' },\n  person: { name: 'FaceAPI MTCNN', modelPath: 'models/faceapi/', score: 0.5, topK: 1, type: 'mtcnn' },\n  */\n};\n\nexport default config;\n","const div = {};\n\nasync function dot() {\n  div.Log.innerHTML += '.';\n}\n\nasync function result(...msg) {\n  let msgs = '';\n  msgs += msg.map((a) => a);\n  if (div && div.Log) div.Log.innerHTML += `${msgs.replace(' ', '&nbsp')}<br>`;\n  div.Log.scrollTop = div.Log.scrollHeight;\n  if (msgs.length > 0) fetch(`/log?msg=${msgs}`).then((res) => res.text());\n  // eslint-disable-next-line no-console\n  console.log(...msg);\n}\n\nasync function active(...msg) {\n  if (div && div.Active) div.Active.innerHTML = `${msg}<br>`;\n  // eslint-disable-next-line no-console\n  else console.log(...msg);\n}\n\nfunction init() {\n  div.Log = document.getElementById('log');\n  div.Active = document.getElementById('active');\n}\n\nconst log = {\n  result,\n  active,\n  init,\n  dot,\n};\n\nexport default log;\n","import config from './config.js';\nimport log from './log.js';\n\nlet results = [];\nlet filtered = [];\nconst popupConfig = {\n  showDetails: true,\n  showBoxes: true,\n  showFaces: true,\n};\nconst listConfig = {\n  showDetails: true,\n};\n\n// draw boxes for detected objects, faces and face elements\nfunction drawBoxes(img, object) {\n  const canvas = document.getElementById('popup-canvas');\n  canvas.style.position = 'absolute';\n  canvas.style.left = img.offsetLeft;\n  canvas.style.top = img.offsetTop;\n  canvas.width = img.width;\n  canvas.height = img.height;\n  const ctx = canvas.getContext('2d');\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.linewidth = 2;\n  ctx.font = '16px Roboto';\n  const resizeX = img.width / object.processedSize.width;\n  const resizeY = img.height / object.processedSize.height;\n\n  // draw detected objects\n  if (popupConfig.showBoxes && object.detect) {\n    ctx.strokeStyle = 'lightyellow';\n    ctx.fillStyle = 'lightyellow';\n    for (const obj of object.detect) {\n      const x = obj.box[0] * resizeX;\n      const y = obj.box[1] * resizeY;\n      ctx.beginPath();\n      ctx.rect(x, y, obj.box[2] * resizeX, obj.box[3] * resizeY);\n      ctx.stroke();\n      ctx.fillText(`${(100 * obj.score).toFixed(0)}% ${obj.class}`, x + 2, y + 18);\n    }\n  }\n\n  // draw faces\n  if (popupConfig.showFaces && object.person && object.person.face) {\n    // draw box around face\n    const x = object.person.face.box.x * resizeX;\n    const y = object.person.face.box.y * resizeY;\n    ctx.strokeStyle = 'deepskyblue';\n    ctx.fillStyle = 'deepskyblue';\n    ctx.beginPath();\n    ctx.rect(x, y, object.person.face.box.width * resizeX, object.person.face.box.height * resizeY);\n    ctx.stroke();\n    ctx.fillText('face', x + 2, y + 18);\n\n    // draw face points\n    ctx.fillStyle = 'lightblue';\n    const pointSize = 2;\n    for (const pt of object.person.face.points) {\n      ctx.beginPath();\n      ctx.arc(pt.x * resizeX, pt.y * resizeY, pointSize, 0, 2 * Math.PI);\n      ctx.fill();\n    }\n\n    /*\n    const jaw = object.person.boxes.landmarks.getJawOutline() || [];\n    const nose = object.person.boxes.landmarks.getNose() || [];\n    const mouth = object.person.boxes.landmarks.getMouth() || [];\n    const leftEye = object.person.boxes.landmarks.getLeftEye() || [];\n    const rightEye = object.person.boxes.landmarks.getRightEye() || [];\n    const leftEyeBrow = object.person.boxes.landmarks.getLeftEyeBrow() || [];\n    const rightEyeBrow = object.person.boxes.landmarks.getRightEyeBrow() || [];\n    faceDetails = `Points jaw:${jaw.length} mouth:${mouth.length} nose:${nose.length} left-eye:${leftEye.length} right-eye:${rightEye.length} left-eyebrow:${leftEyeBrow.length} right-eyebrow:${rightEyeBrow.length}`;\n    */\n  }\n}\n\nfunction JSONtoStr(json) {\n  if (json) return JSON.stringify(json).replace(/{|}|\"/g, '').replace(/,/g, ', ');\n}\n\n// show details popup\nasync function showPopup() {\n  $('#popup').toggle(true);\n  const img = document.getElementById('popup-image');\n  const object = filtered.find((a) => a.image === img.img);\n  if (!object) return;\n\n  let classified = 'Classified ';\n  if (object.classify) for (const obj of object.classify) classified += ` | ${(100 * obj.score).toFixed(0)}% ${obj.class}`;\n\n  let detected = 'Detected ';\n  if (object.detect) for (const obj of object.detect) detected += ` | ${(100 * obj.score).toFixed(0)}% ${obj.class}`;\n\n  let person = '';\n  if (object.person && object.person.age) {\n    person = `Person | \n        Gender: ${(100 * object.person.scoreGender).toFixed(0)}% ${object.person.gender} | \n        Age: ${object.person.age.toFixed(1)} | \n        Emotion: ${(100 * object.person.scoreEmotion).toFixed(0)}% ${object.person.emotion}`;\n  }\n\n  let nsfw = '';\n  if (object.person && object.person.class) {\n    nsfw = `Class: ${(100 * object.person.scoreClass).toFixed(0)}% ${object.person.class} `;\n  }\n\n  let desc = '<h2>Description:</h2><ul>';\n  if (object.descriptions) {\n    for (const description of object.descriptions) {\n      for (const lines of description) {\n        desc += `<li><b>${lines.name}</b>: <i>${lines.desc}</i></li>`;\n      }\n      desc += '<br>';\n    }\n  }\n  desc += '</ul>';\n\n  let exif = '';\n  if (object.exif) {\n    const mp = (img.naturalWidth * img.naturalHeight / 1000000).toFixed(1);\n    const complexity = (img.naturalWidth * img.naturalHeight) / object.exif.bytes;\n    if (object.exif.make) exif += `Camera: ${object.exif.make} ${object.exif.model || ''} ${object.exif.lens || ''}<br>`;\n    if (object.exif.bytes) exif += `Size: ${mp} MP in ${object.exif.bytes.toLocaleString()} bytes with compression factor ${complexity.toFixed(2)}<br>`;\n    if (object.exif.created) exif += `Taken: ${new Date(1000 * object.exif.created).toLocaleString()} Edited: ${new Date(1000 * object.exif.modified).toLocaleString()}<br>`;\n    if (object.exif.software) exif += `Software: ${object.exif.software}<br>`;\n    if (object.exif.exposure) exif += `Settings: ${object.exif.fov || 0}mm ISO${object.exif.iso || 0} f/${object.exif.apperture || 0} 1/${(1 / (object.exif.exposure || 1)).toFixed(0)}sec<br>`;\n  }\n  let location = '';\n  if (object.location && object.location.city) location += `Location: ${object.location.city}, ${object.location.state} ${object.location.country}, ${object.location.continent} (near ${object.location.near})<br>`;\n  if (object.exif && object.exif.lat) location += `Coordinates: Lat ${object.exif.lat.toFixed(3)} Lon ${object.exif.lon.toFixed(3)}<br>`;\n\n  const html = `\n      <h2>Image: ${object.image}</h2>\n      Image size: ${img.naturalWidth} x ${img.naturalHeight}\n        Processed in ${object.perf.total.toFixed(0)} ms<br>\n        Classified using ${config.classify ? config.classify.name : 'N/A'} in ${object.perf.classify.toFixed(0)} ms<br>\n        Detected using ${config.detect ? config.detect.name : 'N/A'} in ${object.perf.detect.toFixed(0)} ms<br>\n        Person using ${config.person ? config.person.name : 'N/A'} in ${object.perf.person.toFixed(0)} ms<br>\n      <h2>Image Data</h2>\n      ${exif}\n      <h2>Location</h2>\n      ${location}\n      <h2>${classified}</h2>\n      <h2>${detected}</h2>\n      <h2>${person} ${nsfw}</h2>\n      ${desc}\n      <h2>Tags</h2>\n      ${JSONtoStr(object.tags)}\n      </div>\n    `;\n  if (popupConfig.showDetails) {\n    $('#popup-details').toggle(true);\n    $('#popup-image').css('max-width', '80vw');\n    $('#popup-details').html(html);\n  } else {\n    $('#popup-details').toggle(false);\n    $('#popup-image').css('max-width', '100vw');\n  }\n  drawBoxes(img, object);\n}\n\nasync function showNextDetails(left) {\n  const img = document.getElementById('popup-image');\n  const id = filtered.findIndex((a) => a.image === img.img);\n  if (id === -1) return;\n  if (left === true && id > 0 && filtered[id - 1]) {\n    img.img = filtered[id - 1].image;\n    img.src = filtered[id - 1].image;\n  } else if (left === false && id <= filtered.length && filtered[id + 1]) {\n    img.img = filtered[id + 1].image;\n    img.src = filtered[id + 1].image;\n  }\n}\n\n// print results strip with thumbnail for a given object\nasync function printResult(object) {\n  let classified = '';\n  if (object.classify && object.classify[0]) {\n    classified = 'Classified';\n    for (const obj of object.classify) classified += ` | ${(100 * obj.score).toFixed(0)}% ${obj.class}`;\n  }\n  let detected = '';\n  if (object.detect && object.detect[0]) {\n    detected = 'Detected';\n    for (const obj of object.detect) detected += ` | ${(100 * obj.score).toFixed(0)}% ${obj.class}`;\n  }\n  let person = '';\n  if (object.person && object.person.age) {\n    person = `Person | \n      Gender: ${(100 * object.person.scoreGender).toFixed(0)}% ${object.person.gender} \n      Age: ${object.person.age.toFixed(1)} \n      Emotion: ${(100 * object.person.scoreEmotion).toFixed(0)}% ${object.person.emotion}`;\n  }\n  let nsfw = '';\n  if (object.person && object.person.class) {\n    nsfw = `Class: ${(100 * object.person.scoreClass).toFixed(0)}% ${object.person.class} `;\n  }\n  let location = '';\n  if (object.location && object.location.city) {\n    location = 'Location';\n    location += ` | ${object.location.city}, ${object.location.state} ${object.location.country}, ${object.location.continent} (near ${object.location.near})`;\n  }\n  let camera = '';\n  if (object.exif.make) {\n    camera = 'Camera';\n    camera += `: ${object.exif.make} ${object.exif.model || ''}`;\n  }\n\n  const divItem = document.createElement('div');\n  divItem.className = 'listitem';\n  divItem.innerHTML = `\n    <div class=\"col thumbnail\" style=\"min-height: ${config.thumbnail}px; max-height: ${config.thumbnail}px; min-width: ${config.thumbnail}px; max-width: ${config.thumbnail}px\">\n      <img id=\"thumb-${object.id}\" src=\"${object.thumbnail}\" align=\"middle\" width=\"${config.thumbnail}px\" height=\"${config.thumbnail}px\">\n    </div>\n    <div id=\"desc-${object.id}\" class=\"col description\">\n      <b>${decodeURI(object.image)}</b><br>\n      Image: ${object.naturalSize.width}x${object.naturalSize.height} ${camera}<br>\n      ${location}<br>\n      ${classified}<br>\n      ${detected}<br>\n      ${person} ${nsfw}<br>\n    </div>\n  `;\n  await $('#results').append(divItem);\n  $('.description').toggle(listConfig.showDetails);\n  document.getElementById(`thumb-${object.id}`).img = object.image;\n  document.getElementById(`desc-${object.id}`).img = object.image;\n  const img = document.getElementById('popup-image');\n  img.addEventListener('load', showPopup);\n  divItem.addEventListener('click', (evt) => {\n    img.img = evt.target.img;\n    img.src = object.image; // this triggers showDetails via onLoad event(\n  });\n}\n\nfunction filterWord(object, word) {\n  if (!object) return null;\n  const skip = ['in', 'a', 'the', 'of', 'with', 'using', 'wearing', 'and', 'at', 'during'];\n  if (skip.includes(word)) return object;\n  const res = object.filter((obj) => {\n    let ok = false;\n    for (const tag of obj.tags) {\n      const str = Object.values(tag)[0].toString() || '';\n      ok |= str.startsWith(word.toLowerCase());\n    }\n    return ok;\n  });\n  return res;\n}\n\nfunction filterResults(words) {\n  filtered = results;\n  let foundWords = 0;\n  for (const word of words.split(' ')) {\n    filtered = filterWord(filtered, word);\n    foundWords += (filtered && filtered.length > 0) ? 1 : 0;\n  }\n  if (filtered && filtered.length > 0) log.result(`Searching for \"${words}\" found ${foundWords} words in ${filtered.length || 0} results out of ${results.length} matches`);\n  else log.result(`Searching for \"${words}\" found ${foundWords} of ${words.split(' ').length} terms`);\n\n  $('#results').html('');\n  $('#number').html(filtered.length);\n  for (const obj of filtered) printResult(obj);\n}\n\n// Fisher-Yates (aka Knuth) Shuffle\nfunction shuffle(array) {\n  let currentIndex = array.length;\n  let temporaryValue;\n  let randomIndex;\n  while (currentIndex !== 0) {\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex -= 1;\n    temporaryValue = array[currentIndex];\n    // eslint-disable-next-line no-param-reassign\n    array[currentIndex] = array[randomIndex];\n    // eslint-disable-next-line no-param-reassign\n    array[randomIndex] = temporaryValue;\n  }\n  return array;\n}\n\nfunction findDuplicates() {\n  filtered = [];\n  for (const obj of results) {\n    const items = results.filter((a) => a.hash === obj.hash);\n    if (items.length !== 1) filtered.push(...items);\n  }\n  filtered = [...new Set(filtered)];\n  $('#results').html('');\n  for (const obj of filtered) printResult(obj);\n}\n\nfunction sortResults(sort) {\n  if (!filtered || filtered.length === 0) filtered = results;\n  if (sort.includes('random')) shuffle(filtered);\n  if (sort.includes('alpha-down')) filtered.sort((a, b) => (a.image > b.image ? 1 : -1));\n  if (sort.includes('alpha-up')) filtered.sort((a, b) => (a.image < b.image ? 1 : -1));\n  if (sort.includes('numeric-down')) filtered.sort((a, b) => (b.exif.created - a.exif.created));\n  if (sort.includes('numeric-up')) filtered.sort((a, b) => (a.exif.created - b.exif.created));\n  if (sort.includes('amount-down')) filtered.sort((a, b) => (b.pixels - a.pixels));\n  if (sort.includes('amount-up')) filtered.sort((a, b) => (a.pixels - b.pixels));\n  $('#results').html('');\n  for (const obj of filtered) printResult(obj);\n}\n\n// calls main detectxion and then print results for all images matching spec\nasync function loadGallery() {\n  log.result('Loading gallery ...');\n  const res = await fetch('/get?find=all');\n  results = await res.json();\n  filtered = results;\n  log.result(`Received ${results.length} images in ${JSON.stringify(results).length.toLocaleString()} bytes`);\n  $('#number').html(results.length);\n  $('#results').html('');\n  for (const id in results) {\n    results[id].id = id;\n    printResult(results[id]);\n  }\n}\n\n// pre-fetching DOM elements to avoid multiple runtime lookups\nfunction initHandlers() {\n  // hide those elements initially\n  $('#popup').toggle(false);\n  $('#searchbar').toggle(false);\n  $('#sortbar').toggle(false);\n  $('#sortbar').toggle(false);\n  $('#configbar').toggle(false);\n\n  $('#btn-search').click(() => {\n    $('#sortbar').toggle(false);\n    $('#configbar').toggle(false);\n    $('#searchbar').toggle('fast');\n    $('#btn-search').toggleClass('fa-search fa-search-location');\n    $('#search-input').focus();\n  });\n\n  $('#search-input').keyup(() => {\n    event.preventDefault();\n    if (event.keyCode === 191) $('#search-input')[0].value = ''; // reset on key=/\n    if (event.keyCode === 13) filterResults($('#search-input')[0].value);\n  });\n\n  $('#btn-sort').click(() => {\n    $('#searchbar').toggle(false);\n    $('#configbar').toggle(false);\n    $('#sortbar').toggle('fast');\n  });\n\n  $('.sortbutton').click((evt) => {\n    sortResults(evt.target.className);\n  });\n\n  $('#btn-desc').click(() => {\n    listConfig.showDetails = !listConfig.showDetails;\n    $('.description').toggle('slow');\n    $('#btn-desc').toggleClass('fa-eye fa-eye-slash');\n  });\n\n  $('#btn-config').click(() => {\n    $('#searchbar').toggle(false);\n    $('#sortbar').toggle(false);\n    $('#configbar').toggle('fast');\n  });\n\n  $('#details-desc').click(() => {\n    $('#details-desc').toggleClass('fa-comment fa-comment-slash');\n    popupConfig.showDetails = !popupConfig.showDetails;\n  });\n  $('#details-boxes').click(() => {\n    $('#details-boxes').toggleClass('fa-store fa-store-slash');\n    popupConfig.showBoxes = !popupConfig.showBoxes;\n  });\n  $('#details-faces').click(() => {\n    $('#details-faces').toggleClass('fa-user fa-user-slash');\n    popupConfig.showFaces = !popupConfig.showFaces;\n  });\n\n  $('#find-duplicates').click(() => {\n    findDuplicates();\n  });\n\n  $('#popup').click(() => {\n    if (event.screenX < 50) showNextDetails(true);\n    else if (event.screenX > window.innerWidth - 50) showNextDetails(false);\n    else $('#popup').toggle('fast');\n  });\n\n  $('html').keydown(() => {\n    const current = $('#results').scrollTop();\n    const page = $('#results').height();\n    const bottom = $('#results').prop('scrollHeight');\n    $('#results').stop();\n    switch (event.keyCode) {\n      case 33:\n      case 36: $('#results').animate({ scrollTop: 0 }, 1000); break; // pgup or home\n      case 34:\n      case 35: $('#results').animate({ scrollTop: bottom }, 1000); break; // pgdn or end\n      case 38: $('#results').animate({ scrollTop: current - page + 36 }, 400); break; // up\n      case 40: $('#results').animate({ scrollTop: current + page - 36 }, 400); break; // down\n      case 37: showNextDetails(true); break;\n      case 39: showNextDetails(false); break;\n      case 191: $('#btn-search').click(); break; // key=/\n      case 190: $('#btn-sort').click(); break; // key=.\n      case 32: $('#btn-desc').click(); break; // key=space\n      case 82:\n        $('#results').scrollTop(0);\n        loadGallery();\n        break; // r\n      case 27:\n        $('#searchbar').toggle(false);\n        $('#sortbar').toggle(false);\n        $('#sortbar').toggle(false);\n        $('#configbar').toggle(false);\n        $('#popup').toggle(false);\n        break; // escape\n      default: // log.result('Unhandled keydown event', event.keyCode);\n    }\n  });\n}\n\nasync function main() {\n  log.init();\n  initHandlers();\n  await loadGallery();\n}\n\nwindow.onload = main;\n"]}