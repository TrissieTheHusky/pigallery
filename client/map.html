<html>
  <head>
    <script type="text/javascript" src="https://api.mqcdn.com/sdk/mapquest-js/v1.3.2/mapquest.js"></script>
    <script type="text/javascript" src="https://leaflet.github.io/Leaflet.heat/dist/leaflet-heat.js"></script>
    <link type="text/css" rel="stylesheet" href="https://api.mqcdn.com/sdk/mapquest-js/v1.3.2/mapquest.css"/>
    <script type="text/javascript">
      async function main() {
        // https://developer.mapquest.com/documentation/mapquest-js/v1.3/
        L.mapquest.key = 'lYrP4vF3Uk5zgTiGGuEzQGwGIVDGuy24';
        const map = L.mapquest.map('map', {
          center: [25.7632076, -80.1927073],
          layers: L.mapquest.tileLayer('map'),
          zoom: 3,
        });
        L.mapquest.geocodingControl().addTo(map);
        const res = await fetch('/api/get?limit=1000&find=all');
        let all = [];
        if (res && res.ok) all = await res.json();
        const points = all
          .filter((a) => (a.exif && a.exif.lat && a.exif.lon))
          .map((a) => [a.exif.lat, a.exif.lon, 0.1]);
        const heat = { maxZoom: 15, max: 1.0, radius: 25, blur: 15, minOpacity: 0.3 };
        L.heatLayer(points, heat).addTo(map);
      }
      window.onload = main;
    </script>
  </head>
  <body>
    <div id="map" style="width: 100%; height: 100%;"></div>
  </body>
</html>